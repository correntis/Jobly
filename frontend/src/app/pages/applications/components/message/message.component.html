<div class="py-1 px-2">
  <!-- User Message -->
  <div
    *ngIf="isUserMessage()"
    class="flex"
    [class.justify-end]="isSender()"
    [class.justify-start]="!isSender()"
  >
    <div
      class="max-w-[70%] px-4 py-3 rounded-2xl"
      [class.bg-gradient-to-br]="isSender()"
      [class.from-primary-500]="isSender()"
      [class.to-accent-500]="isSender()"
      [class.text-white]="isSender()"
      [class.glass-card-subtle]="!isSender()"
      [class.rounded-br-sm]="isSender()"
      [class.rounded-bl-sm]="!isSender()"
    >
      <p class="text-sm leading-relaxed break-words">{{ message?.content }}</p>
      
      <div class="flex items-center gap-2 mt-2 text-xs" [class.justify-end]="isSender()">
        <span *ngIf="message?.editedAt" class="opacity-70">изменено</span>
        <span class="opacity-70">{{ message?.sentAt | date:'HH:mm' }}</span>
        <mat-icon 
          *ngIf="isSender()" 
          class="text-sm"
          [class.opacity-70]="!message?.isRead"
        >
          {{ message?.isRead ? 'done_all' : 'done' }}
        </mat-icon>
      </div>
    </div>
  </div>

  <!-- System Message -->
  <div *ngIf="isCreationMessage()" class="flex justify-center my-4">
    <div class="glass-card-subtle px-6 py-3 rounded-full text-center">
      <p class="text-sm text-[var(--text-primary)]">{{ message?.content }}</p>
      <p class="text-xs text-[var(--text-muted)] mt-1">
        {{ message?.sentAt | date:'d MMM yyyy, HH:mm' }}
      </p>
    </div>
  </div>
</div>
