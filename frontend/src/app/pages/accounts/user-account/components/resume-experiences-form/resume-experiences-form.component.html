<div class="glass-card p-6 mb-6">
  <div class="flex items-center justify-between mb-6">
    <h2 class="section-title mb-0 flex items-center gap-2">
      <mat-icon class="text-accent-500">work</mat-icon>
      Опыт работы
    </h2>
    <button type="button" (click)="addJobExperience()" class="text-sm text-[var(--accent-primary)] hover:underline flex items-center gap-1">
      <mat-icon class="text-sm">add</mat-icon> Добавить
    </button>
  </div>

  <form [formGroup]="jobExperiencesForm" (ngSubmit)="saveJobExperiences()">
    <div formArrayName="jobExperiences" class="space-y-4">
      <div
        *ngFor="let exp of jobExperiences.controls; let i = index"
        [formGroupName]="i"
        class="glass-card-subtle p-4"
      >
        <div class="flex items-start justify-between mb-3">
          <span class="text-sm font-semibold text-[var(--text-primary)]">Опыт {{ i + 1 }}</span>
          <button
            type="button"
            (click)="removeJobExperience(i)"
            class="text-[var(--text-muted)] hover:text-error-500 transition-colors"
          >
            <mat-icon class="text-lg">close</mat-icon>
          </button>
        </div>

        <div class="space-y-3">
          <input
            formControlName="jobTitle"
            class="glass-input text-sm py-2"
            placeholder="Должность"
          />
          <input
            formControlName="companyName"
            class="glass-input text-sm py-2"
            placeholder="Компания"
          />
          <div class="grid grid-cols-2 gap-3">
            <div class="space-y-1">
              <label class="text-xs text-[var(--text-muted)]">Начало</label>
              <input
                type="date"
                formControlName="startDate"
                class="glass-input text-sm py-2"
              />
            </div>
            <div class="space-y-1">
              <label class="text-xs text-[var(--text-muted)]">Окончание</label>
              <input
                type="date"
                formControlName="endDate"
                class="glass-input text-sm py-2"
              />
            </div>
          </div>

          <!-- Responsibilities -->
          <div formArrayName="responsibilities" class="space-y-2">
            <div class="flex items-center justify-between">
              <label class="text-xs text-[var(--text-muted)]">Обязанности</label>
              <button type="button" (click)="addResponsibility(i)" class="text-xs text-[var(--accent-primary)] hover:underline">
                + Добавить
              </button>
            </div>
            <div class="space-y-2">
              <div
                *ngFor="let resp of getResponsibilities(i).controls; let j = index"
                class="flex items-center gap-2"
              >
                <input
                  [formControlName]="j"
                  class="glass-input text-sm py-2 flex-1"
                  placeholder="Обязанность"
                />
                <button type="button" (click)="removeResponsibility(i, j)" class="text-[var(--text-muted)] hover:text-error-500">
                  <mat-icon class="text-sm">close</mat-icon>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <button *ngIf="jobExperiences.length > 0" type="submit" class="glass-btn py-3 px-6 mt-4">
      Сохранить
    </button>
  </form>
</div>
